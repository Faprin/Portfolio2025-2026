<section id="contact" class="py-20 px-6 bg-white dark:bg-gray-950">
  <div class="max-w-2xl mx-auto">
    <div class="text-center mb-12">
      <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">
        Empecemos a trabajar juntos
      </h2>
      <p class="text-gray-600 dark:text-gray-400">
        ¿Tienes algún proyecto en mente o simplemente quieres saludar? Rellena
        el formulario y te contestaré lo antes posible.
      </p>
    </div>

    <form class="space-y-6">
      <div class="grid md:grid-cols-2 gap-6">
        <div>
          <label
            for="name"
            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"
            >Nombre</label
          >
          <input
            type="text"
            id="name"
            name="name"
            class="w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white outline-none transition-all"
            placeholder="Tu nombre"
            required
          />
        </div>
        <div>
          <label
            for="email"
            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"
            >Email</label
          >
          <input
            type="email"
            id="email"
            name="email"
            class="w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white outline-none transition-all"
            placeholder="tucorreo@ejemplo.com"
            required
          />
        </div>
      </div>

      <div>
        <label
          for="message"
          class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"
          >Mensaje</label
        >
        <textarea
          id="message"
          name="message"
          rows="5"
          class="w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-lg focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white outline-none transition-all resize-none"
          placeholder="Cuéntame sobre tu proyecto..."
          required></textarea>
      </div>

      <button
        type="submit"
        class="w-full py-4 bg-gray-900 dark:bg-white text-white dark:text-gray-900 font-bold rounded-lg hover:opacity-90 transition-opacity"
      >
        Enviar Mensaje
      </button>
    </form>
  </div>
</section>

<script>
  import emailjs from "@emailjs/browser";

  const form = document.querySelector("form") as HTMLFormElement;
  const submitBtn = form.querySelector(
    'button[type="submit"]',
  ) as HTMLButtonElement;
  const originalBtnText = submitBtn.innerText;

  form.addEventListener("submit", (e) => {
    e.preventDefault();

    submitBtn.disabled = true;
    submitBtn.innerText = "Enviando...";

    emailjs
      .sendForm(
        import.meta.env.PUBLIC_EMAILJS_SERVICE_ID,
        import.meta.env.PUBLIC_EMAILJS_TEMPLATE_ID,
        form,
        {
          publicKey: import.meta.env.PUBLIC_EMAILJS_PUBLIC_KEY,
        },
      )
      .then(
        () => {
          alert("¡Mensaje enviado con éxito!");
          form.reset();
        },
        (error) => {
          console.error("FAILED...", error);
          alert(
            "Hubo un error al enviar el mensaje. Por favor, inténtalo de nuevo.",
          );
        },
      )
      .finally(() => {
        submitBtn.disabled = false;
        submitBtn.innerText = originalBtnText;
      });
  });
</script>
